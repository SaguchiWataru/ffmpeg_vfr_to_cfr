# ffmpegを使った自動で動画を変換してくれるbatファイル

## 作った理由

この機能を作ろうと思ったきっかけは、動画ファイルを可変フレームレート (VFR) から固定フレームレート (CFR) に変換したかったからです。  
iPhone 8 で撮影できる映像は VFR の mov ファイルです。  
そのため、Adobe Premiere Elements 14 のような動画編集ソフトでは音ズレが起きてしまいます。  
この問題を解消するためには、 VFR から CFR に変換する必要があります。  
しかし、頻繁に動画を変換する身としては、動画変換ソフトの設定を毎回変更するのは効率が悪いです。  
また、公開する作品は相当な画質を維持する必要がある場合があります。  

## 特徴

* 動画ファイルを bat ファイルにドラッグ＆ドドロップするだけで自動で変換してくれます
* 複数の動画をまとめてドラッグ＆ドロップできます
* 画質や音質の設定も出力先の設定もする必要がありません
* 一般的に使われている動画変換ソフトよりも画質と音質を維持できます

## 仕様

* 入力パス : カレントディレクトリ
* 出力パス : カレントディレクトリ
* ffmpeg.exeのディレクトリ : カレントディレクトリ
* 動画ファイルのディレクトリ : カレントディレクトリ
* crf値 (画質) : 16 (値が小さいほど高画質 値が小さいほど容量が増加)
* r値 (フレームレート) : 60 (fps テレビと同等)
* ab (音声のビットレート) : 1411 (kbps CDと同等)

ちょっとやり過ぎなくらい画質と音質を優先しました。  

## ダウンロード

細心の注意を払って作成しましたが、不具合や損害を保証するものではありません。  
[ffmpeg_CPU_crf16_r60_ab1411k.bat](https://github.com/SaguchiWataru/ffmpeg_vfr_to_cfr/blob/master/source/ffmpeg_CPU_crf16_r60_ab1411k.bat)  

ffmpeg.exeは別途公式サイトからダウンロードしてください。  
[FFmpeg公式サイト](https://ffmpeg.org/download.html)  

## 最後に

この記事を最後まで読んでいただきありがとうございます。  
もしも、企業の方で僕に興味を持って頂けた方がいらっしゃったら幸いです。  
最近は、[AtCoder](https://atcoder.jp/users/K019C1053)というプログラミングコンテストに毎週参加しています。  
プログラミングのレベルを他の人と相対的に可視化できるサイトなので、よろしければご確認ください。  
[K019C1053のコンテスト実績](https://atcoder.jp/users/K019C1053)  
K019C1053は、日本工学院専門学校の佐口航の学籍番号です。  

2023年卒業予定です！  

## ソースコード

```ffmpeg CPU crf16 r60 ab1411k.bat
ECHO OFF
 
:REPEAT
ffmpeg.exe -i %1 -crf 16 -r 60 -ab 1411k "%~n1_H_264_CPUEnc_crf16_r60_ab1411k.mp4"

if "%~2"=="" GOTO EXIT
shift
GOTO REPEAT
:EXIT
pause
```
